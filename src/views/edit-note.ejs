<%- include('partials/header') %>
<link rel="stylesheet" href="https://unpkg.com/easymde/dist/easymde.min.css">
<script src="https://unpkg.com/easymde/dist/easymde.min.js"></script>

<div class="notes-page-container">
    <div class="book-header">
        <img src="<%= book.cover_image_url || '/images/placeholder.png' %>" alt="Cover of <%= book.title %>">
        <div class="book-header-info">
            <h2><%= book.title %></h2>
            <p>by <%= book.author %></p>
        </div>
    </div>

    <div class="add-note-container">
        <h3>Edit Note</h3>
        <form action="/notes/edit/<%= note.id %>" method="POST">
            <div class="form-group">
                <label for="excerpt">Excerpt / Highlight</label>
                <textarea name="excerpt" id="excerpt" rows="3"><%= note.excerpt || '' %></textarea>
            </div>
            <div class="location-inputs">
                <div class="form-group">
                    <label for="chapter">Chapter</label>
                    <input type="text" id="chapter" name="chapter" value="<%= note.chapter || '' %>">
                </div>
                <div class="form-group">
                    <label for="page">Page</label>
                    <input type="text" id="page" name="page" value="<%= note.page || '' %>">
                </div>
            </div>
            <div class="form-group">
                <label for="markdown-editor">Your Note</label>
                <textarea name="content_markdown" id="markdown-editor"><%= note.content_markdown %></textarea>
            </div>
            <div class="form-group">
                <label for="tags">Tags (comma-separated)</label>
                <input type="text" id="tags" name="tags" value="<%= note.tags %>">
            </div>
            <div class="form-actions">
                <button type="submit" class="btn btn-sm">Update Note</button>
                <a href="/notes/<%= note.book_id %>" class="btn btn-sm btn-secondary">Cancel</a>
            </div>
        </form>
    </div>
</div>

<script>
    const easyMDE = new EasyMDE({
        element: document.getElementById('markdown-editor'),
        spellChecker: false,
        minHeight: '250px',
    });
</script>

<%- include('partials/footer') %>